<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="MemberMapper">

 

    <!-- 회원 전체 조회 -->
    <select id="selectAllMembers" resultType="model.user.User">
        SELECT * FROM USERS 
    </select>

    <!-- 회원 삭제 -->
    <delete id="deleteMemberById" parameterType="string">
        DELETE FROM USERS
        WHERE USER_ID = #{userId}
    </delete>

    <!-- 회원 단건 조회 -->
    <select id="selectUser" resultType="model.user.User">
        SELECT * FROM USERS WHERE USER_ID = #{userId, jdbcType=VARCHAR}
    </select>
	
	
	<select id="selectMembersByPage" resultType="model.user.User">
	    SELECT * FROM (
	        SELECT u.*, ROW_NUMBER() OVER (ORDER BY CREATE_DT DESC) AS rn
	        FROM USERS u
	    )
	    WHERE rn BETWEEN #{startRow} AND #{endRow}
	</select>
	
	<!-- 전체 회원 수 조회 -->
	<select id="selectTotalMemberCount" resultType="int">
	    SELECT COUNT(*) FROM USERS
	</select>
	
	<select id="getMembersByPage" resultType="model.user.User">
	    SELECT * FROM (
	        SELECT u.*, ROW_NUMBER() OVER (ORDER BY CREATE_DT DESC) AS rn
	        FROM USERS u
	    )
	    WHERE rn BETWEEN #{offset} + 1 AND #{offset} + #{pageSize}
	</select>
</mapper>